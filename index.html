
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Music Shares</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #fafafa; }
.container { max-width: 600px; margin: 0 auto; background: white; min-height: 100vh; }
.header { display: flex; justify-content: space-between; padding: 12px 16px; border-bottom: 1px solid #dbdbdb; background: white; position: sticky; top: 0; z-index: 100; }
.logo { font-size: 24px; font-weight: 600; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.input-group { margin: 20px; padding: 12px; border: 1px solid #dbdbdb; border-radius: 8px; }
.input-group input { width: 100%; padding: 12px; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; }
.btn-primary { width: 100%; padding: 12px; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; }
.auth-box { background: white; padding: 40px; border-radius: 12px; width: 100%; max-width: 400px; margin: 100px auto; }
.auth-logo { text-align: center; font-size: 32px; font-weight: 700; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 30px; }
.hidden { display: none; }
#app>*:not(.hidden) { display: block; }
  .nav { display: flex; gap: 20px; }
.nav-btn { background: none; border: none; font-size: 24px; cursor: pointer; color: #262626; }
.nav-btn.active { color: #8b5cf6; }
.feed { padding-bottom: 60px; }
.post { border-bottom: 1px solid #dbdbdb; margin-bottom: 20px; }
.post-header { display: flex; align-items: center; padding: 14px 16px; gap: 12px; }
.avatar { width: 32px; height: 32px; border-radius: 50%; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px; }
.post-user { font-weight: 600; font-size: 14px; }
.post-time { font-size: 12px; color: #8e8e8e; margin-left: auto; }
.post-image { width: 100%; aspect-ratio: 1; object-fit: cover; background: #f0f0f0; }
.post-actions { display: flex; gap: 16px; padding: 12px 16px; }
.action-btn { background: none; border: none; font-size: 24px; cursor: pointer; color: #262626; }
.action-btn.liked { color: #ed4956; }
.post-likes { padding: 0 16px; font-weight: 600; font-size: 14px; margin-bottom: 8px; }
.post-caption { padding: 0 16px; font-size: 14px; margin-bottom: 8px; }
.post-caption-user { font-weight: 600; margin-right: 6px; }
.post-comments { padding: 0 16px; margin-bottom: 12px; }
.comment { font-size: 14px; margin-bottom: 6px; }
.comment-user { font-weight: 600; margin-right: 6px; }
.add-comment { padding: 12px 16px; border-top: 1px solid #efefef; display: flex; gap: 8px; }
.comment-input { flex: 1; border: none; outline: none; font-size: 14px; }
.comment-btn { background: none; border: none; color: #0095f6; font-weight: 600; cursor: pointer; font-size: 14px; }
.empty-state { text-align: center; padding: 60px 20px; color: #8e8e8e; }
.empty-icon { font-size: 64px; margin-bottom: 16px; }
.empty-text { font-size: 18px; font-weight: 600; margin-bottom: 8px; }
.empty-hint { font-size: 14px; }
</style>
</head>
<body>
<div id="app"></div>
<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
import { getFirestore, collection, addDoc, query, orderBy, 54
        from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
import { getStorage } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';

const firebaseConfig = {
apiKey: "AIzaSyDXNvc9z-wzwpJ_PLCVYdG-xPFQmIUIAho",
authDomain: "truly-made-4d5e0.firebaseapp.com",
projectId: "truly-made-4d5e0",
storageBucket: "truly-made-4d5e0.firebasestorage.app",
messagingSenderId: "26168906760",
appId: "1:26168906760:web:f498d8d5cd0580329dedbd"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const db = getFirestore();
const storage = getStorage();

let currentUser = null;

function renderAuth() {
return `
<div class="auth-box">
let currentView = 'feed';
let posts = [];
let selectedFile = null;
<div class="auth-logo">Music Shares</div>
<div class="input-group">
<input type="email" id="email" placeholder="Email" style="background:white;color:#000;border:1px solid #dbdbdb;margin-bottom:12px;">
<input type="password" id="password" placeholder="Password" style="background:white;color:#000;border:1px solid #dbdbdb;margin-bottom:16px;">
<button id="login-btn" class="btn-primary">Sign In</button>
<button id="signup-btn" class="btn-primary" style="margin-top:12px;">Create Account</button>
</div>
</div>
`;
}

window.logout = () => auth.signOut();

onAuthStateChanged(auth, (user) => {
currentUser = user;
if (user) {
renderApp();
} else {
renderAuthPage();
}
});

function renderAuthPage() {
document.getElementById('app').innerHTML = renderAuth();
document.getElementById('login-btn').onclick = async () => {
const email = document.getElementById('email').value;
const password = document.getElementById('password').value;
try {
await signInWithEmailAndPassword(auth, email, password);
} catch (e) {
alert(e.message);
}
};
document.getElementById('signup-btn').onclick = async () => {
const email = document.getElementById('email').value;
const password = document.getElementById('password').value;
try {
await createUserWithEmailAndPassword(auth, email, password);
} catch (e) {
alert(e.message);
}
};
}

function renderApp() {
document.getElementById('app').innerHTML = ``
  <div class="container">
    <div class="header">
      <div class="logo">Music Shares</div>
      <button onclick="logout()" style="background:none;border:none;cursor:pointer;font-size:14px;">Logout</button>
    </div>
    <div class="nav">
      <button class="nav-btn ${currentView==='feed'?'active':''}" onclick="switchView('feed')">ðŸ“¸ Feed</button>
      <button class="nav-btn ${currentView==='upload'?'active':''}" onclick="switchView('upload')">âž• Upload</button>
      <button class="nav-btn ${currentView==='profile'?'active':''}" onclick="switchView('profile')">ðŸ‘¤ Profile</button>
      <button class="nav-btn ${currentView==='notifications'?'active':''}" onclick="switchView('notifications')">ðŸ”” Notifications</button>
    </div>
    <div id="view-content">
      ${currentView === 'feed' ? '<div class="empty-state"><div class="empty-icon">ðŸ“¸</div><div class="empty-text">No posts yet</div><div class="empty-hint">Be the first to share!</div></div>' : ''}
      ${currentView === 'upload' ? '<div class="empty-state"><div class="empty-icon">âž•</div><div class="empty-text">Upload view</div><div class="empty-hint">Coming soon...</div></div>' : ''}
      ${currentView === 'profile' ? '<div class="empty-state"><div class="empty-icon">ðŸ‘¤</div><div class="empty-text">Your Profile</div><div class="empty-hint">User: '+currentUser.email+'</div></div>' : ''}
      ${currentView === 'notifications' ? '<div class="empty-state"><div class="empty-icon">ðŸ””</div><div class="empty-text">No notifications</div><div class="empty-hint">You\'re all caught up!</div></div>' : ''}
    </div>
  </div>
  `;
`;
}

  function switchView(view) {
  currentView = view;
  renderApp();
}

  async function loadPosts() {
  try {
    const q = query(collection(db, 'posts'), orderBy('timestamp', 'desc'));
    const querySnapshot = await getDocs(q);
    posts = [];
    querySnapshot.forEach((doc) => {
      posts.push({ id: doc.id, ...doc.data() });
    });
    if (currentView === 'feed') renderApp();
  } catch (e) {
    console.error('Error loading posts:', e);
  }
}

async function uploadPost() {
  if (!selectedFile) {
    alert('Please select a photo');
    return;
  }
  if (selectedFile.size > 10485760) {
    alert('File too large. Max 10MB');
    return;
  }
  try {
    const storageRef = ref(storage, `photos/${currentUser.uid}/${Date.now()}_${selectedFile.name}`);
    await uploadBytes(storageRef, selectedFile);
    const photoURL = await getDownloadURL(storageRef);
    const caption = document.getElementById('caption-input').value || '';
    await addDoc(collection(db, 'posts'), {
      photoURL,
      caption,
      userId: currentUser.uid,
      userEmail: currentUser.email,
      timestamp: serverTimestamp(),
      likes: [],
      comments: []
    });
    selectedFile = null;
    document.getElementById('file-input').value = '';
    document.getElementById('caption-input').value = '';
    alert('Photo uploaded!');
    switchView('feed');
    loadPosts();
  } catch (e) {
    alert('Upload failed: ' + e.message);
  }
}
</script>
</body>
</html>
