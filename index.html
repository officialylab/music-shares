<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Music Shares</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #000; min-height: 100vh; overflow-x: hidden; }
.logo { font-family: 'Brush Script MT', cursive; font-size: 32px; font-weight: 400; color: white; }
.container { max-width: 100%; margin: 0 auto; background: #000; min-height: 100vh; }
.header { background: #000; padding: 12px 16px; border-bottom: 1px solid #262626; position: sticky; top: 0; z-index: 99; display: flex; align-items: center; justify-content: space-between; }
.header-icons { display: flex; gap: 20px; align-items: center; }
.header-icon { font-size: 26px; color: white; text-decoration: none; cursor: pointer; }
.stories-container { background: #000; border-bottom: 1px solid #262626; padding: 16px 0; overflow-x: auto; white-space: nowrap; }
.stories-container::-webkit-scrollbar { display: none; }
.story { display: inline-block; text-align: center; padding: 0 10px; cursor: pointer; }
.story-avatar { width: 66px; height: 66px; border-radius: 50%; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); padding: 3px; margin: 0 auto 8px; }
.story-avatar img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 2px solid #000; }
.story-name { font-size: 12px; color: white; max-width: 70px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.feed { padding-bottom: 60px; }
.post { background: #000; margin-bottom: 12px; border-bottom: 1px solid #262626; }
.post-header { display: flex; align-items: center; padding: 12px 16px; }
.post-avatar { width: 32px; height: 32px; border-radius: 50%; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px; margin-right: 10px; }
.post-user { font-weight: 600; font-size: 14px; color: white; }
.post-time { font-size: 12px; color: #8e8e8e; margin-left: auto; }
.post-image { width: 100%; aspect-ratio: 1; object-fit: cover; background: #1a1a1a; }
.post-actions { display: flex; gap: 16px; padding: 12px 16px; align-items: center; }
.action-btn { background: none; border: none; font-size: 26px; cursor: pointer; color: white; transition: opacity 0.2s; }
.action-btn:active { opacity: 0.5; }
.action-btn.liked { color: #ed4956; }
.bookmark-btn { margin-left: auto; }
.post-likes { padding: 0 16px; font-weight: 600; font-size: 14px; margin-bottom: 8px; color: white; }
.post-caption { padding: 0 16px; font-size: 14px; margin-bottom: 8px; color: white; }
.post-caption-user { font-weight: 600; margin-right: 6px; }
.post-comments { padding: 0 16px; margin-bottom: 12px; }
.comment { font-size: 14px; margin-bottom: 6px; color: white; }
.comment-user { font-weight: 600; margin-right: 6px; }
.nav { display: flex; justify-content: space-around; background: #000; border-top: 1px solid #262626; position: fixed; bottom: 0; left: 0; right: 0; z-index: 99; padding: 8px 0; }
.nav-btn { background: none; border: none; flex: 1; padding: 8px; font-size: 26px; cursor: pointer; color: white; transition: opacity 0.2s; }
.nav-btn.active { opacity: 1; }
.nav-btn:not(.active) { opacity: 0.4; }
.empty-state { text-align: center; padding: 60px 20px; color: #8e8e8e; }
.empty-icon { font-size: 64px; margin-bottom: 16px; }
.empty-text { font-size: 18px; font-weight: 600; margin-bottom: 8px; color: white; }
.empty-hint { font-size: 14px; color: #8e8e8e; }
.auth-box { background: #000; padding: 40px; border: 1px solid #262626; border-radius: 3px; width: 100%; max-width: 400px; margin: 100px auto; }
.auth-logo { text-align: center; font-size: 48px; font-weight: 700; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 30px; font-family: 'Brush Script MT', cursive; }
.input-group input { width: 100%; padding: 12px; background: #fff; color: #000; border: 1px solid #dbdbdb; border-radius: 3px; margin-bottom: 12px; font-size: 14px; }
.btn-primary { width: 100%; padding: 12px; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 14px; }
.fab-btn { position: fixed; bottom: 80px; right: 20px; width: 60px; height: 60px; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); border-radius: 50%; border: none; font-size: 32px; color: white; cursor: pointer; box-shadow: 0 4px 12px rgba(139,92,246,0.4); z-index: 98; }
.profile-header { padding: 20px; border-bottom: 1px solid #262626; }
.profile-info { display: flex; align-items: center; margin-bottom: 20px; }
.profile-avatar-large { width: 86px; height: 86px; border-radius: 50%; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 36px; font-weight: 600; }
.profile-stats { flex: 1; display: flex; justify-content: space-around; padding: 0 20px; }
.stat { text-align: center; }
.stat-value { font-weight: 600; font-size: 18px; color: white; }
.stat-label { font-size: 14px; color: #8e8e8e; margin-top: 4px; }
.profile-bio { margin-top: 12px; }
.profile-name { font-weight: 600; font-size: 14px; color: white; margin-bottom: 4px; }
.profile-email { font-size: 14px; color: #8e8e8e; }
.posts-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; }
.grid-post { aspect-ratio: 1; background: #1a1a1a; cursor: pointer; overflow: hidden; }
.grid-post img { width: 100%; height: 100%; object-fit: cover; }
.modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); z-index: 999; align-items: center; justify-content: center; }
.modal.active { display: flex; }
.modal-content { background: #000; border-radius: 12px; max-width: 400px; width: 90%; padding: 24px; border: 1px solid #262626; }
.modal-title { font-size: 20px; font-weight: 600; margin-bottom: 20px; color: white; text-align: center; }
.modal input, .modal textarea { width: 100%; padding: 12px; background: #1a1a1a; color: white; border: 1px solid #262626; border-radius: 8px; margin-bottom: 16px; font-size: 14px; font-family: inherit; }
.modal textarea { min-height: 100px; resize: vertical; }
.modal-actions { display: flex; gap: 12px; }
.modal-btn { flex: 1; padding: 12px; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 14px; border: none; }
.modal-btn-primary { background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); color: white; }
.modal-btn-secondary { background: #262626; color: white; }
</style>
</head>
<body>
<div id="app"></div>
<div id="uploadModal" class="modal">
<div class="modal-content">
<div class="modal-title">Create Post</div>
<input type="file" id="file-input" accept="image/*" style="margin-bottom:16px;">
<textarea id="caption-input" placeholder="Write a caption..."></textarea>
<div class="modal-actions">
<button class="modal-btn modal-btn-secondary" onclick="document.getElementById('uploadModal').classList.remove('active')">Cancel</button>
<button class="modal-btn modal-btn-primary" onclick="uploadPost()">Post</button>
</div>
</div>
</div>
<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
import { getFirestore, collection, addDoc, query, orderBy, getDocs, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
import { getStorage, ref, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';

const firebaseConfig = {
apiKey: "AIzaSyDXNvc9z-wzwpJ_PLCVYdG-xPFQmIUIAho",
authDomain: "truly-made-4d5e0.firebaseapp.com",
projectId: "truly-made-4d5e0",
storageBucket: "truly-made-4d5e0.firebasestorage.app",
messagingSenderId: "26168906760",
appId: "1:26168906760:web:f498d8d5cd0580329dedbd"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const db = getFirestore();
const storage = getStorage();
let currentUser = null;
let currentView = 'feed';
let posts = [];
let selectedFile = null;

function renderAuth() {
return `
<div class="auth-box">
<div class="auth-logo">Music Shares</div>
<div class="input-group">
<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Password">
<button id="login-btn" class="btn-primary">Sign In</button>
<button id="signup-btn" class="btn-primary" style="margin-top:12px;">Create Account</button>
</div>
</div>
`;
}

window.logout = () => auth.signOut();

onAuthStateChanged(auth, (user) => {
currentUser = user;
if (user) {
renderApp();
loadPosts();
} else {
renderAuthPage();
}
});

function renderAuthPage() {
document.getElementById('app').innerHTML = renderAuth();
document.getElementById('login-btn').onclick = async () => {
const email = document.getElementById('email').value;
const password = document.getElementById('password').value;
try {
await signInWithEmailAndPassword(auth, email, password);
} catch (e) {
alert(e.message);
}
};
document.getElementById('signup-btn').onclick = async () => {
const email = document.getElementById('email').value;
const password = document.getElementById('password').value;
try {
await createUserWithEmailAndPassword(auth, email, password);
} catch (e) {
alert(e.message);
}
};
}

function renderApp() {
const storiesHTML = `
<div class="stories-container">
<div class="story"><div class="story-avatar"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60'%3E%3Crect fill='%23${Math.floor(Math.random()*16777215).toString(16)}' width='60' height='60'/%3E%3C/svg%3E"></div><div class="story-name">Your Story</div></div>
${Array.from({length: 12}, (_, i) => `<div class="story"><div class="story-avatar"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60'%3E%3Crect fill='%23${Math.floor(Math.random()*16777215).toString(16)}' width='60' height='60'/%3E%3C/svg%3E"></div><div class="story-name">user${i+1}</div></div>`).join('')}
</div>
`;

const feedHTML = posts.length > 0 ? `
<div class="feed">
${posts.map(post => `
<div class="post">
<div class="post-header">
<div class="post-avatar">${post.userEmail.charAt(0).toUpperCase()}</div>
<div class="post-user">${post.userEmail.split('@')[0]}</div>
<div class="post-time">2h</div>
</div>
<img class="post-image" src="${post.photoURL}" alt="Post">
<div class="post-actions">
<button class="action-btn">‚ô•</button>
<button class="action-btn">üí¨</button>
<button class="action-btn">‚úà</button>
<button class="action-btn bookmark-btn">üîñ</button>
</div>
<div class="post-likes">${Math.floor(Math.random()*1000)} likes</div>
<div class="post-caption"><span class="post-caption-user">${post.userEmail.split('@')[0]}</span>${post.caption || 'No caption'}</div>
</div>
`).join('')}
</div>
<button class="fab-btn" onclick="document.getElementById('uploadModal').classList.add('active')">+</button>
` : `
<div class="empty-state">
<div class="empty-icon">üì∏</div>
<div class="empty-text">No posts yet</div>
<div class="empty-hint">Tap + to share your first photo!</div>
</div>
<button class="fab-btn" onclick="document.getElementById('uploadModal').classList.add('active')">+</button>
`;

const searchHTML = `
<div style="padding:20px;">
<input type="text" placeholder="Search users..." style="width:100%;padding:14px;border:1px solid #262626;border-radius:8px;font-size:14px;background:#1a1a1a;color:white;">
</div>
<div class="empty-state">
<div class="empty-icon">üîç</div>
<div class="empty-text">Search for users</div>
</div>
`;

const profileHTML = `
<div class="profile-header">
<div class="profile-info">
<div class="profile-avatar-large">${currentUser.email.charAt(0).toUpperCase()}</div>
<div class="profile-stats">
<div class="stat"><div class="stat-value">${posts.filter(p => p.userId === currentUser.uid).length}</div><div class="stat-label">posts</div></div>
<div class="stat"><div class="stat-value">0</div><div class="stat-label">followers</div></div>
<div class="stat"><div class="stat-value">0</div><div class="stat-label">following</div></div>
</div>
</div>
<div class="profile-bio">
<div class="profile-name">${currentUser.email.split('@')[0]}</div>
<div class="profile-email">${currentUser.email}</div>
</div>
</div>
<div class="posts-grid">
${posts.filter(p => p.userId === currentUser.uid).length > 0 ? posts.filter(p => p.userId === currentUser.uid).map(post => `<div class="grid-post"><img src="${post.photoURL}" alt="Post"></div>`).join('') : '<div class="empty-state" style="grid-column:1/4;padding:40px 20px;"><div class="empty-icon">üì∏</div><div class="empty-text">No Posts Yet</div><div class="empty-hint">Share your first photo!</div></div>'}
</div>
`;

const notificationsHTML = `
<div class="empty-state">
<div class="empty-icon">üîî</div>
<div class="empty-text">No notifications</div>
<div class="empty-hint">You're all caught up!</div>
</div>
`;

document.getElementById('app').innerHTML = `
<div class="container">
<div class="header">
<div class="logo">Music Shares</div>
<div class="header-icons">
<span class="header-icon" onclick="alert('Notifications')">‚ô•</span>
<span class="header-icon" onclick="alert('Messages')">‚úà</span>
</div>
</div>
${currentView === 'feed' ? storiesHTML : ''}
<div id="view-content">
${currentView === 'feed' ? feedHTML : ''}
${currentView === 'search' ? searchHTML : ''}
${currentView === 'profile' ? profileHTML : ''}
${currentView === 'notifications' ? notificationsHTML : ''}
</div>
<div class="nav">
<button class="nav-btn ${currentView==='feed'?'active':''}" onclick="switchView('feed')">üè†</button>
<button class="nav-btn ${currentView==='search'?'active':''}" onclick="switchView('search')">üîç</button>
<button class="nav-btn ${currentView==='add'?'active':''}" onclick="document.getElementById('uploadModal').classList.add('active')">‚ûï</button>
<button class="nav-btn ${currentView==='notifications'?'active':''}" onclick="switchView('notifications')">‚ô•</button>
<button class="nav-btn ${currentView==='profile'?'active':''}" onclick="switchView('profile')">üë§</button>
</div>
</div>
`;
}

window.switchView = (view) => {
currentView = view;
renderApp();
};

async function loadPosts() {
try {
const q = query(collection(db, 'posts'), orderBy('timestamp', 'desc'));
const querySnapshot = await getDocs(q);
posts = [];
querySnapshot.forEach((doc) => {
posts.push({ id: doc.id, ...doc.data() });
});
if (currentView === 'feed' || currentView === 'profile') renderApp();
} catch (e) {
console.error('Error loading posts:', e);
}
}

window.uploadPost = async function() {
if (!selectedFile) {
alert('Please select a photo');
return;
}
if (selectedFile.size > 10485760) {
alert('File too large. Max 10MB');
return;
}
try {
const storageRef = ref(storage, `photos/${currentUser.uid}/${Date.now()}_${selectedFile.name}`);
await uploadBytes(storageRef, selectedFile);
const photoURL = await getDownloadURL(storageRef);
const caption = document.getElementById('caption-input').value || '';
await addDoc(collection(db, 'posts'), {
photoURL,
caption,
userId: currentUser.uid,
userEmail: currentUser.email,
timestamp: serverTimestamp(),
likes: [],
comments: []
});
selectedFile = null;
document.getElementById('file-input').value = '';
document.getElementById('caption-input').value = '';
document.getElementById('uploadModal').classList.remove('active');
alert('Photo uploaded!');
switchView('feed');
loadPosts();
} catch (e) {
alert('Upload failed: ' + e.message);
}
};

document.addEventListener('DOMContentLoaded', () => {
const fileInput = document.getElementById('file-input');
if (fileInput) {
fileInput.addEventListener('change', (e) => {
selectedFile = e.target.files[0];
});
}
});

</script>
</body>
</html>
